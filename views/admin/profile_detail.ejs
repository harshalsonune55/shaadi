<%- layout("layouts/navbar.ejs") %>

<div class="max-w-5xl mx-auto p-6">
  <div class="bg-white rounded-2xl shadow p-8">

    <!-- HEADER -->
    <div class="flex items-center gap-6 mb-6">
      <img
        src="<%= profile.image || 'https://ui-avatars.com/api/?name=' + profile.first_name %>"
        alt="Profile Image"
        class="w-28 h-28 rounded-full border object-cover"
      />

      <div>
        <h1 class="text-3xl font-bold text-gray-900">
          <%= profile.first_name %> <%= profile.last_name %>
        </h1>

        <p class="text-gray-600">
          <%= profile.work || "‚Äî" %>
        </p>

        <p class="text-gray-500 text-sm">
          üìç <%= profile.address || "Not specified" %>
        </p>

        <!-- PHONE NUMBER -->
        <p class="text-gray-700 mt-1">
          üìû <strong><%= phone || "Not available" %></strong>
        </p>
      </div>
    </div>

    <hr class="my-6" />

    <!-- ABOUT -->
    <h2 class="text-xl font-semibold text-gray-900 mb-2">About</h2>
    <p class="text-gray-700 mb-6 leading-relaxed">
      <%= profile.about || "No about section provided." %>
    </p>
    <% if (profile.govtIdImages && profile.govtIdImages.length && !profile.isVerified) { %>
      <hr class="my-6" />
    
      <h2 class="text-xl font-semibold mb-3">Government ID Documents</h2>
    
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-6">
        <% profile.govtIdImages.forEach((img) => { %>
          <div class="border rounded-xl overflow-hidden shadow-sm">
            <img
              src="<%= img %>"
              alt="Government ID"
              class="w-full h-48 object-cover hover:scale-105 transition-transform"
            />
          </div>
        <% }) %>
      </div>
    
      <form action="/admin/verify/<%= profile._id %>" method="POST">
        <button
          class="bg-green-600 text-white px-6 py-3 rounded-lg font-semibold
                 hover:bg-green-700 transition shadow"
        >
          ‚úÖ Approve Verification
        </button>
      </form>
    <% } %>
    
    

    <!-- EXPERTISE & INTERESTS -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

      <!-- EXPERTISE -->
      <div>
        <h3 class="font-semibold text-gray-900 mb-2">Expertise</h3>
        <div class="flex flex-wrap gap-2">
          <% if (profile.expertise && profile.expertise.length) { %>
            <% profile.expertise.forEach(e => { %>
              <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">
                #<%= e %>
              </span>
            <% }) %>
          <% } else { %>
            <p class="text-gray-500 text-sm">No expertise added</p>
          <% } %>
        </div>
      </div>

      <!-- INTERESTS -->
      <div>
        <h3 class="font-semibold text-gray-900 mb-2">Interests</h3>
        <div class="flex flex-wrap gap-2">
          <% if (profile.interests && profile.interests.length) { %>
            <% profile.interests.forEach(i => { %>
              <span class="bg-red-100 text-red-700 px-3 py-1 rounded-full text-sm">
                #<%= i %>
              </span>
            <% }) %>
          <% } else { %>
            <p class="text-gray-500 text-sm">No interests added</p>
          <% } %>
        </div>
      </div>

    </div>

    <!-- MEMBERSHIP STATUS -->
    <div class="mt-8">
      <p class="text-gray-800">
        <strong>Membership:</strong>
        <% if (profile.isSubscribed) { %>
          <span class="text-green-600 font-semibold ml-1">Active</span>
        <% } else { %>
          <span class="text-gray-500 font-semibold ml-1">Inactive</span>
        <% } %>
      </p>
    </div>

    <!-- DELETE PROFILE (ADMIN ONLY) -->
<div class="mt-10 border-t pt-6">
  <form
    action="/admin/profile/<%= profile._id %>/delete"
    method="POST"
    onsubmit="return confirm('‚ö†Ô∏è Are you sure you want to permanently delete this profile? This action cannot be undone.')"
  >
    <button
      type="submit"
      class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold
             hover:bg-red-700 transition shadow"
    >
      üóë Delete Profile
    </button>
  </form>
</div>


    <!-- BACK LINK -->
    <div class="mt-8">
      <a
        href="/profiles"
        class="inline-block text-blue-600 hover:underline font-medium"
      >
        ‚Üê Back to Profiles
      </a>
    </div>

  </div>
</div>
