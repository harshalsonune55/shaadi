


 <!DOCTYPE html>
 <html lang="en">
   <head>
     <meta charset="UTF-8" />
     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
     <title>Shaadiwali</title>
     <link rel="icon" href="/images/Logo1.jpeg" type="image/jpeg" />
 
     <!-- Tailwind CSS -->
     <script src="https://cdn.tailwindcss.com"></script>
     <link rel="stylesheet" href="/home.css">
 
     <!-- Font Awesome -->
     <link
       rel="stylesheet"
       href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
       crossorigin="anonymous"
       referrerpolicy="no-referrer"
     />
     


   </head>
   <body class="bg-gray-50">
 
     <!-- Header -->
     <header class="bg-white shadow-md">
       <div class="container mx-auto flex justify-between items-center px-4 py-3">
         <!-- Logo + Title -->
         <div class="flex items-center space-x-3">
           <img src="/images/Logo1.jpeg" alt="Logo" class="w-10 h-10 rounded-full" />
           <h1 class="text-2xl font-bold text-pink-600">
             <a href="/">SHAADIWALI</a>
           </h1>
         </div>
 
         <!-- Hamburger button for mobile -->
         <button id="menu-btn" class="text-gray-600 text-2xl md:hidden focus:outline-none">
           <i class="fa-solid fa-bars"></i>
         </button>
 
         <!-- Navbar links -->
         <nav id="menu" class="hidden md:flex items-center space-x-6 text-gray-700 font-medium">
           <a href="/" class="flex flex-col items-center hover:text-pink-600">
             <i class="fa-solid fa-house text-xl mb-1"></i>
             Home
           </a>
 
           <% if (!user) { %>
            <a href="/pricing" class="flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-tag text-xl mb-1"></i>
              Pricing
            </a>
             <a href="/login" class="flex flex-col items-center hover:text-pink-600">
               <i class="fa-solid fa-right-to-bracket text-xl mb-1"></i>
               Login
             </a>
             
             <a href="/login" class="flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-user-plus text-xl mb-1"></i>
              Create Account
            </a>
            <a href="/blogs" class="flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-blog text-xl mb-1"></i>
              Blogs
            </a>

           <% } else { %>
            <a href="/people" class="flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-user-group text-xl mb-1"></i>
              People
            </a>
            <a href="/inbox" class="relative flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-comments text-xl mb-1"></i>
            
              <!-- BADGE -->
              <span
                id="inboxBadge"
                class="hidden absolute -top-1 -right-2 bg-red-600 text-white text-xs px-1.5 rounded-full"
              >
                0
              </span>
            
              Inbox
            </a>
            
            
          
            <% if (!userProfile || !userProfile.isSubscribed) { %>
              <a href="/pricing" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
                <i class="fa-solid fa-tag text-pink-600"></i>
                <span>Pricing</span>
              </a>
            <% } %>
            <a href="/profile" class="flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-circle-user text-xl mb-1"></i>
              Profile
            </a>
           
            
           
            <a href="/blogs" class="flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-blog text-xl mb-1"></i>
              Blogs
            </a>
            <% if (isAdmin) { %>
              <a href="/admin" class="flex flex-col items-center text-red-600 hover:text-red-700">
                <i class="fa-solid fa-user-shield text-xl mb-1"></i>
                Admin
              </a>
            <% } %>
            <a href="/logout" class="flex flex-col items-center hover:text-pink-600">
              <i class="fa-solid fa-right-from-bracket text-xl mb-1"></i>
              Logout
            </a>
           <% } %>
 
           
         </nav>
       </div>
 
       <!-- Mobile Menu -->
       <!-- Mobile Menu -->
<div
id="mobile-menu"
class="hidden md:hidden fixed top-16 left-0 w-full bg-white shadow-lg z-50"
>
<div class="grid grid-cols-2 gap-4 p-4 text-gray-700">

  <a href="/" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
    <i class="fa-solid fa-house text-pink-600"></i>
    <span>Home</span>
  </a>

  <% if (!user) { %>

    <a href="/login" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-right-to-bracket text-pink-600"></i>
      <span>Login</span>
    </a>
    <a href="/pricing" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-tag text-pink-600"></i>
      <span>Pricing</span>
    </a>

    <a href="/login"
      class="col-span-2 text-center bg-pink-600 text-white py-3 rounded-lg font-semibold">
      <i class="fa-solid fa-user-plus mr-2"></i>
      Create Account
    </a>
    <a href="/blogs" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-blog text-pink-600"></i>
      <span>Blogs</span>
    </a>
    

  <% } else { %>

    <a href="/people" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-user-group text-pink-600"></i>
      <span>People</span>
    </a>

    <a href="/inbox" class="relative flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-comments text-pink-600"></i>
      <span>Inbox</span>
    
      <!-- MOBILE BADGE -->
      <span
        id="mobileInboxBadge"
        class="hidden absolute top-1 right-3 bg-red-600 text-white text-xs px-1.5 rounded-full"
      >
        0
      </span>
    </a>
    

    <a href="/pricing" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-tag text-pink-600"></i>
      <span>Pricing</span>
    </a>
    
    

    <a href="/profile" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-circle-user text-pink-600"></i>
      <span>Profile</span>
    </a>
    <a href="/blogs" class="flex items-center gap-3 p-3 rounded-lg hover:bg-pink-50">
      <i class="fa-solid fa-blog text-pink-600"></i>
      <span>Blogs</span>
    </a>
    

    <% if (isAdmin) { %>
      <a href="/admin"
        class="col-span-2 flex items-center justify-center gap-3 p-3 rounded-lg bg-red-50 text-red-600">
        <i class="fa-solid fa-user-shield"></i>
        Admin Panel
      </a>
    <% } %>

    <a href="/logout"
      class="col-span-2 text-center bg-gray-200 py-3 rounded-lg font-semibold">
      <i class="fa-solid fa-right-from-bracket mr-2"></i>
      Logout
    </a>

  <% } %>

</div>
</div>

     </header>
 
     <%- body %>
 
     <!-- Toggle Script -->
     <script>
       const menuBtn = document.getElementById('menu-btn');
       const menu = document.getElementById('menu');
       const mobileMenu = document.getElementById('mobile-menu');
 
       menuBtn.addEventListener('click', () => {
         mobileMenu.classList.toggle('hidden');
       });
     </script>
     <script src="/socket.io/socket.io.js"></script>
     <script>
      // Initialize Socket.io
      window.socket = io();
    
      window.socket.on("connect", () => {
        console.log("üü¢ Socket Connected! ID:", window.socket.id);
    
        <% if (user && user.phone) { %>
          // Use the phone number from the user session to join the room
          window.socket.emit("join user room", "<%= user.phone %>");
          
        <% } %>
      });
    
      window.socket.on("disconnect", () => {
        console.log("üî¥ Socket Disconnected");
      });
    
      window.socket.on("connect_error", (err) => {
        console.error("‚ùå Socket Connection Error:", err);
      });
    </script>
    <script>
      const menuBtn = document.getElementById('menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
    
      menuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    
      document.querySelectorAll('#mobile-menu a').forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.add('hidden');
        });
      });
    </script>
    <script>
      const inboxBadge = document.getElementById("inboxBadge");
      const mobileInboxBadge = document.getElementById("mobileInboxBadge");
    
      // Fetch initial unread count
      fetch("/api/unread-count")
        .then(res => res.json())
        .then(data => {
          updateBadge(data.count);
        });
    
      function updateBadge(count) {
        if (count > 0) {
          inboxBadge?.classList.remove("hidden");
          mobileInboxBadge?.classList.remove("hidden");
    
          inboxBadge.textContent = count;
          mobileInboxBadge.textContent = count;
        } else {
          inboxBadge?.classList.add("hidden");
          mobileInboxBadge?.classList.add("hidden");
        }
      }
    
      // Listen for live updates
      window.socket.on("unread_count", (count) => {
        updateBadge(count);
      });
    </script>
    
    
    
     

     
   </body>
 </html>
 