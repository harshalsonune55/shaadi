 <%- layout("/layouts/navbar.ejs") %>
<link rel="stylesheet" href="/profile.css">

<!-- <div class="profile-page">
  <div class="profile-container">
    <div class="profile-header">
      <img 
        src="<%= userProfile?.profilePicture || 'https://via.placeholder.com/100' %>" 
        alt="Profile Picture" 
        class="profile-pic"
      >
      <h2><%= user.fullname || user.username %></h2>
      <p class="title"><%= userProfile?.title || 'Member' %></p>
      <div class="tags">
        <% if (userProfile?.tags && userProfile.tags.length > 0) { %>
          <% userProfile.tags.forEach(tag => { %>
            <span class="tag"><%= tag %></span>
          <% }) %>
        <% } else { %>
          <span class="tag">New User</span>
        <% } %>
      </div>
      <div class="edit-button-container" style="margin-top: 10px;">
        <a href="/profile/edit/<%=user.id%>" class="edit-button">Edit Profile</a>
      </div>
    </div>

    <div class="profile-content">
      <div class="card">
        <h3>Personal Information</h3>
        <ul>
          <li><strong>Email:</strong> <%= user.email %></li>
          <li><strong>Gender:</strong> <%= userProfile?.gender || 'Not specified' %></li>
          <li><strong>Age:</strong> <%= userProfile?.age ? userProfile.age + ' years old' : 'Not specified' %></li>
          <li><strong>Location:</strong> <%= userProfile?.location || 'Not specified' %></li>
        </ul>
      </div>

      <div class="card">
        <h3>Professional Background</h3>
        <ul>
          <li><strong>Education:</strong> <%= userProfile?.education || 'Not specified' %></li>
          <li><strong>Current Roles:</strong></li>
          <div class="roles">
            <% if (userProfile?.roles && userProfile.roles.length > 0) { %>
              <% userProfile.roles.forEach(role => { %>
                <span class="tag"><%= role %></span>
              <% }) %>
            <% } else { %>
              <span class="tag">No roles added</span>
            <% } %>
          </div>
        </ul>
      </div>
    </div>
  </div>
</div>-->





<div class="main-full-profile-page">
    <div class="profile-page">
        <div class="profile-container">
            <div class="profile-header">
                <div class="verified-badge">
                    <span>‚úì</span>
                    <span>Verified Profile</span>
                </div>
                
                <img 
                    src="https://ui-avatars.com/api/?name=Priya+Sharma&size=150&background=ff6b6b&color=fff&bold=true" 
                    alt="Profile Picture" 
                    class="profile-pic"
                    id="profilePic"
                >
                
                <h2 id="displayName"> <%= user.first_name %> <%= user.last_name %></h2>
                <p class="title" id="displayTitle"><%=user.title%></p>
                
                <div class="tags" id="tagsContainer">
                    <span class="tag">MBA Graduate</span>
                    <span class="tag">Never Married</span>
                    <span class="tag">Hindu</span>
                    <span class="tag">Non-Smoker</span>
                </div>

                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-value">26</span>
                        <span class="stat-label">Years Old</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">5'4"</span>
                        <span class="stat-label">Height</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">Mumbai</span>
                        <span class="stat-label">Location</span>
                    </div>
                </div>

                <div class="edit-button-container">
                    <a href="#" class="edit-button" onclick="toggleEditMode(event)">‚úèÔ∏è Edit Profile</a>
                </div>
            </div>

            <div class="profile-content">
                <div class="card">
                    <h3>Personal Information</h3>
                    <ul>
                        <li>
                            <strong>Email:</strong> 
                            <span class="display-text">priya.sharma@example.com</span>
                            <input type="email" class="edit-input" value="priya.sharma@example.com" style="display: none;">
                        </li>
                        <li>
                            <strong>Gender:</strong> 
                            <span class="display-text">Female</span>
                            <select class="edit-input" style="display: none;">
                                <option value="Female" selected>Female</option>
                                <option value="Male">Male</option>
                                <option value="Other">Other</option>
                            </select>
                        </li>
                        <li>
                            <strong>Age:</strong> 
                            <span class="display-text">26 years old</span>
                            <input type="number" class="edit-input" value="26" style="display: none;">
                        </li>
                        <li>
                            <strong>Location:</strong> 
                            <span class="display-text">Mumbai, Maharashtra</span>
                            <input type="text" class="edit-input" value="Mumbai, Maharashtra" style="display: none;">
                        </li>
                        <li>
                            <strong>Marital Status:</strong> 
                            <span class="display-text">Never Married</span>
                            <select class="edit-input" style="display: none;">
                                <option value="Never Married" selected>Never Married</option>
                                <option value="Divorced">Divorced</option>
                                <option value="Widowed">Widowed</option>
                            </select>
                        </li>
                        <li>
                            <strong>Religion:</strong> 
                            <span class="display-text">Hindu</span>
                            <input type="text" class="edit-input" value="Hindu" style="display: none;">
                        </li>
                        <li>
                            <strong>Mother Tongue:</strong> 
                            <span class="display-text">Hindi</span>
                            <input type="text" class="edit-input" value="Hindi" style="display: none;">
                        </li>
                    </ul>
                </div>

                <div class="card">
                    <h3>Professional Background</h3>
                    <ul>
                        <li>
                            <strong>Education:</strong> 
                            <span class="display-text">MBA in Finance</span>
                            <input type="text" class="edit-input" value="MBA in Finance" style="display: none;">
                        </li>
                        <li>
                            <strong>Occupation:</strong> 
                            <span class="display-text">Financial Analyst</span>
                            <input type="text" class="edit-input" value="Financial Analyst" style="display: none;">
                        </li>
                        <li>
                            <strong>Company:</strong> 
                            <span class="display-text">Fortune 500 Company</span>
                            <input type="text" class="edit-input" value="Fortune 500 Company" style="display: none;">
                        </li>
                        <li>
                            <strong>Annual Income:</strong> 
                            <span class="display-text">‚Çπ8-10 Lakhs</span>
                            <input type="text" class="edit-input" value="‚Çπ8-10 Lakhs" style="display: none;">
                        </li>
                        <li>
                            <strong>Current Roles:</strong>
                            <div class="roles">
                                <span class="tag">Finance Professional</span>
                                <span class="tag">Team Leader</span>
                                <span class="tag">MBA Graduate</span>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="card">
                    <h3>Family Details</h3>
                    <ul>
                        <li>
                            <strong>Father:</strong> 
                            <span class="display-text">Business Owner</span>
                            <input type="text" class="edit-input" value="Business Owner" style="display: none;">
                        </li>
                        <li>
                            <strong>Mother:</strong> 
                            <span class="display-text">Homemaker</span>
                            <input type="text" class="edit-input" value="Homemaker" style="display: none;">
                        </li>
                        <li>
                            <strong>Siblings:</strong> 
                            <span class="display-text">1 Brother (Married)</span>
                            <input type="text" class="edit-input" value="1 Brother (Married)" style="display: none;">
                        </li>
                        <li>
                            <strong>Family Type:</strong> 
                            <span class="display-text">Nuclear Family</span>
                            <select class="edit-input" style="display: none;">
                                <option value="Nuclear Family" selected>Nuclear Family</option>
                                <option value="Joint Family">Joint Family</option>
                            </select>
                        </li>
                        <li>
                            <strong>Family Status:</strong> 
                            <span class="display-text">Middle Class</span>
                            <select class="edit-input" style="display: none;">
                                <option value="Middle Class" selected>Middle Class</option>
                                <option value="Upper Middle Class">Upper Middle Class</option>
                                <option value="Rich">Rich</option>
                            </select>
                        </li>
                    </ul>
                </div>

                <div class="card">
                    <h3>About Me</h3>
                    <ul>
                        <li>
                            <span class="display-text">I am a warm, caring, and ambitious professional looking for a life partner who values family, education, and personal growth. I believe in maintaining a balance between tradition and modernity. I enjoy reading, cooking, and traveling. Looking for someone who is respectful, understanding, and shares similar values.</span>
                            <textarea class="edit-input" rows="5" style="display: none;">I am a warm, caring, and ambitious professional looking for a life partner who values family, education, and personal growth. I believe in maintaining a balance between tradition and modernity. I enjoy reading, cooking, and traveling. Looking for someone who is respectful, understanding, and shares similar values.</textarea>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="save-button-container" id="saveBar">
        <button class="save-button" onclick="saveChanges()">üíæ Save Changes</button>
        <button class="cancel-button" onclick="cancelEdit()">‚úñ Cancel</button>
    </div>
</div>

    <script>
        let isEditMode = false;
        let originalValues = {};

        function toggleEditMode(event) {
            event.preventDefault();
            isEditMode = !isEditMode;
            
            const container = document.querySelector('.profile-container');
            const editButton = document.querySelector('.edit-button');
            const saveBar = document.getElementById('saveBar');
            const displayTexts = document.querySelectorAll('.display-text');
            const editInputs = document.querySelectorAll('.edit-input');

            if (isEditMode) {
                // Store original values
                editInputs.forEach((input, index) => {
                    if (input.tagName === 'TEXTAREA') {
                        originalValues[index] = input.value;
                    } else if (input.tagName === 'SELECT') {
                        originalValues[index] = input.value;
                    } else {
                        originalValues[index] = input.value;
                    }
                });

                container.classList.add('edit-mode');
                editButton.textContent = 'üëÅÔ∏è View Mode';
                editButton.style.background = '#40c057';
                editButton.style.color = 'white';
                saveBar.classList.add('visible');

                displayTexts.forEach(text => text.style.display = 'none');
                editInputs.forEach(input => input.style.display = 'block');
            } else {
                container.classList.remove('edit-mode');
                editButton.textContent = '‚úèÔ∏è Edit Profile';
                editButton.style.background = 'white';
                editButton.style.color = '#c92a2a';
                saveBar.classList.remove('visible');

                displayTexts.forEach(text => text.style.display = 'inline');
                editInputs.forEach(input => input.style.display = 'none');
            }
        }

        function saveChanges() {
            // Get all edit inputs
            const editInputs = document.querySelectorAll('.edit-input');
            const displayTexts = document.querySelectorAll('.display-text');

            // Update display texts with input values
            editInputs.forEach((input, index) => {
                if (displayTexts[index]) {
                    if (input.tagName === 'TEXTAREA') {
                        displayTexts[index].textContent = input.value;
                    } else if (input.tagName === 'SELECT') {
                        displayTexts[index].textContent = input.options[input.selectedIndex].text;
                    } else {
                        displayTexts[index].textContent = input.value;
                    }
                }
            });

            // Show success message
            alert('‚úÖ Profile updated successfully!');

            // Exit edit mode
            const editButton = document.querySelector('.edit-button');
            editButton.click();
        }

        function cancelEdit() {
            // Restore original values
            const editInputs = document.querySelectorAll('.edit-input');
            editInputs.forEach((input, index) => {
                if (originalValues[index] !== undefined) {
                    input.value = originalValues[index];
                }
            });

            // Exit edit mode
            const editButton = document.querySelector('.edit-button');
            editButton.click();
        }
    </script>
<%- include("layouts/footer.ejs") %> 